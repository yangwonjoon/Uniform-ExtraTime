import{r as i,c as g,d as u,q as h,o as b,w as y,g as j,k as P,l as w,M as N,N as v,O as S,P as R,Q as I,u as x,e as m,j as e}from"./index-0d2ZcZCT.js";const k=s=>{const[t,r]=i.useState([]);return i.useEffect(()=>{(async()=>{if(!s)return;const c=g(u,"products"),l=h(c,y("userEmail","==",s),b("createdAt","desc"));try{const a=await j(l);console.log(a);const d=a.docs.map(n=>({productId:n.id,...n.data()}));r(d)}catch{console.log("useReadProduct 에러")}})()},[s]),t},D=()=>async(t,r,o)=>{const c=P(u,"products",t);try{if((await w(c)).exists()){const a=`products/${r}/${o}`,d=N(v,a),f=(await S(d)).items.map(p=>R(p));await Promise.all(f),console.log("Storage에서 폴더와 파일들 삭제 완료"),await I(c),console.log("Firestore에서 문서 삭제 완료:",t)}else console.log("해당 문서를 찾을 수 없습니다:",t)}catch(l){console.log("삭제 실패:",l)}},E=({product:s})=>{const t=x(),r=m(c=>c.user),o=D();return e.jsxs("div",{className:"w-9/10 h-48 mx-auto my-5 flex overflow-hidden shadow-lg rounded-lg border border-black",children:[e.jsx("div",{className:"flex flex-grow basis-3/10 items-center justify-center p-3 w-48",children:e.jsx("img",{src:s.productImages[0],alt:"메인 이미지",className:"object-contain max-h-full"})}),e.jsxs("div",{className:"flex flex-grow basis-1/2 flex-col p-3",children:[e.jsx("h1",{className:"font-bold text-lg",children:s.productName}),e.jsxs("p",{className:"font-semibold text-md mb-5",children:["가격: ",s.productPrice]}),e.jsx("p",{className:"text-sm",children:s.productDescription})]}),e.jsx("div",{className:"flex flex-grow basis-2/10 flex-col p-3 justify-around items-center",children:!s.isSell&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-blue-500 text-white rounded-md",onClick:()=>t(`/sell/updateProduct/${s.productId}`),children:"수정"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white rounded-md",onClick:()=>{s.productId&&o(s.productId,r.email,s.productName)},children:"삭제"})]})})]})},B=()=>{const s=x(),t=m(o=>o.user),r=k(t.email);return e.jsxs("div",{children:[e.jsx("div",{className:"text-right",children:e.jsx("button",{type:"button",onClick:()=>s("/sell/createProduct"),className:"text-base font-medium py-2 px-4 border border-gray text-gray-800 rounded hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50 mt-3",children:"상품등록"})}),e.jsx("h1",{className:"font-bold text-xl my-5",children:"판매중인 상품"}),e.jsx("hr",{}),r&&r.map(o=>e.jsx(E,{product:o},o.productId))]})};export{B as default};
